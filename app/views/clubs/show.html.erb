<div class="container">
  <div class="player-card" id="club-page">
    <div class="avatar-team">
      <% if @club.user.photo.attached? %>
        <%= cl_image_tag @club.user.photo.key , height: 100, width: 100, crop: :fill, class: "avatar-team" %>
      <% else %>
        <%= image_tag "https://res.cloudinary.com/dgwgea5k3/image/upload/v1591359130/Unbenanndsfst-1_rukblo.jpg", class: "avatar-team" %>
      <% end %>
     <%= link_to '<i class="far fa-edit"></i>'.html_safe, edit_user_registration_path %>
    </div>
    <div class="club-card-info">
      <h4>Boris Paillard<%#= @club.user.email --- for demo purpose%></h4>
      <h5><%= @club.name %>,
        <% @club.club_tournaments.each do |club_tournament| %>
          <%= club_tournament.tournament.league if club_tournament.tournament.season_year == "2019/2020" && club_tournament.tournament.tournament_type == "championship" %>
        <% end %>
      </h5>
    </div>
    <div class="club-card-budget">
      <div class="budget-item">
        <p>Current budget</p>
        <p><%= number_to_currency(@club.budget, delimiter: '.', locale: "fr",unit: "€ ") %> </p>
      </div>
      <div class="budget-item">
        <p>Sum salaries</p>
        <p><%= number_to_currency(@club.players.sum(:salary), delimiter: '.', locale: "fr",unit: "€ ") %></p>
      </div>
      <div class="budget-item">
        <p>Remaining budget</p>
        <% remain_budget = @club.budget - @club.players.sum(:salary) %>
        <p><strong><%= number_to_currency(remain_budget, delimiter: '.', locale: "fr",unit: "€ ") %></strong></p>
      </div>
      <div class="spacer"></div>
      <div class="cta">
        <%= link_to '<i class="far fa-edit"></i> Budget'.html_safe, edit_club_path(@club), class: "button"  %>
      </div>
      <div class="spacer"></div>
    </div>
  </div>

  <div class="team-overview">
    <h1>My Team</h1>
      <div class="position-table">
        <h5> Goalkeeper </h5>
        <table class="team-player-overview">
          <tr>
            <th> </th>
            <th> </th>
            <th> </th>
            <th> </th>
          </tr>
          <% @current_players.each do |player| %>
            <% if player[:position] == "Goalkeeper" %>
              <div>
                <tr class="player-card-small">
                  <td id="td-name"> <%= image_tag(player[:image])%></td>
                  <td> <%= player[:name] %></td>
                  <td> <%= player[:position] %></td>
                  <td> <%= player[:current_game_qty] %> <%= image_tag('game_qty.svg') %></td>
                  <td> <%= player[:current_goals] %> <%= image_tag('goals.svg') %></td>
                  <td> <%= player[:current_starting_elv_avg]%> % <%= image_tag('starting_eleven.svg') %></td>
                  <td> <%= player[:salary]%> €</td>
                </tr>
              </div>
            <% end %>
          <% end %>
        </table>
      </div>

      <div class="position-table">
        <h5> Defender </h5>
        <table class="team-player-overview">
          <tr>
            <th> </th>
            <th> </th>
            <th> </th>
            <th> </th>
          </tr>

          <% @current_players.each do |player| %>
            <% if player[:position] == "Defender" %>
              <div>
                <tr class="player-card-small">
                  <td id="td-name"> <%= image_tag(player[:image])%></td>
                  <td class="left"><%= player[:name] %></td>
                  <td> <%= player[:position] %></td>
                  <td> <%= player[:current_game_qty] %> <%= image_tag('game_qty.svg') %></td>
                  <td> <%= player[:current_goals] %> <%= image_tag('goals.svg') %></td>
                  <td> <%= player[:current_starting_elv_avg]%> % <%= image_tag('starting_eleven.svg') %></td>
                  <td> <%= player[:salary]%> €</td>
                </tr>
              </div>
            <% end %>
          <% end %>
        </table>
      </div>

      <div class="position-table">
        <h5> Midfielder </h5>
        <table class="team-player-overview">
          <tr>
            <th> </th>
            <th> </th>
            <th> </th>
            <th> </th>
          </tr>

          <% @current_players.each do |player| %>
            <% if player[:position] == "Midfielder" %>
              <div>
                <tr class="player-card-small">
                  <td id="td-name"> <%= image_tag(player[:image])%></td>
                  <td class="left"><%= player[:name] %></td>
                  <td> <%= player[:position] %></td>
                  <td> <%= player[:current_game_qty] %> <%= image_tag('game_qty.svg') %></td>
                  <td> <%= player[:current_goals] %> <%= image_tag('goals.svg') %></td>
                  <td> <%= player[:current_starting_elv_avg]%> % <%= image_tag('starting_eleven.svg') %></td>
                  <td> <%= player[:salary]%> €</td>
                </tr>
              </div>
            <% end %>
          <% end %>
        </table>
      </div>
      <div class="position-table">
        <h5> Striker </h5>
        <table class="team-player-overview">
          <tr>
            <th> </th>
            <th> </th>
            <th> </th>
            <th> </th>
          </tr>

          <% @current_players.each do |player| %>
            <% if player[:position] == "Striker" %>
              <div>
                <tr class="player-card-small">
                  <td id="td-name"> <%= image_tag(player[:image]) %></td>
                  <td> <%= player[:name] %></td>
                  <td> <%= player[:position] %></td>
                  <td> <%= player[:current_game_qty] %> <%= image_tag('game_qty.svg') %></td>
                  <td> <%= player[:current_goals] %> <%= image_tag('goals.svg') %></td>
                  <td> <%= player[:current_starting_elv_avg]%> % <%= image_tag('starting_eleven.svg') %></td>
                  <td> <%= player[:salary]%> €</td>
                </tr>
              </div>
            <% end %>
          <% end %>
        </table>
      </div>
  </div>
</div>
